from datafeed.dataloader import CSVDataloader
import copy,re

symbols = [
    '159934.SZ',  # 黄金ETF（黄金）
    # '511260.SH',  # 十年国债ETF（债券）
    '161716.SZ',
    '512890.SH',  # 红利低波（股票）
    '159985.SZ',  # 豆粕（商品）
    '513100.SH'  # 纳指100
]
df = CSVDataloader.get_df(symbols, set_index=True)


def convert_inverse_prim(prim, args):
    """
    Convert inverse prims according to:
    [Dd]iv(a,b) -> Mul[a, 1/b]
    [Ss]ub(a,b) -> Add[a, -b]
    We achieve this by overwriting the corresponding format method of the sub and div prim.
    """
    prim = copy.copy(prim)
    df = CSVDataloader.get_df(symbols, set_index=True)

    converter = {
        'Add': lambda *args_: "{}+{}".format(*args_),
        'Mul': lambda *args_: "{}*{}".format(*args_),
        'fsub': lambda *args_: "{}-{}".format(*args_),
        'fdiv': lambda *args_: "{}/{}".format(*args_),
        'fmul': lambda *args_: "{}*{}".format(*args_),
        'fadd': lambda *args_: "{}+{}".format(*args_),
        # 'fmax': lambda *args_: "max_({},{})".format(*args_),
        # 'fmin': lambda *args_: "min_({},{})".format(*args_),

        'isub': lambda *args_: "{}-{}".format(*args_),
        'idiv': lambda *args_: "{}/{}".format(*args_),
        'imul': lambda *args_: "{}*{}".format(*args_),
        'iadd': lambda *args_: "{}+{}".format(*args_),
        # 'imax': lambda *args_: "max_({},{})".format(*args_),
        # 'imin': lambda *args_: "min_({},{})".format(*args_),
    }

    prim_formatter = converter.get(prim.name, prim.format)

    return prim_formatter(*args)

def stringify_for_sympy(f):
    """Return the expression in a human readable string.
    """
    string = ""
    stack = []
    for node in f:
        stack.append((node, []))
        while len(stack[-1][1]) == stack[-1][0].arity:
            prim, args = stack.pop()
            string = convert_inverse_prim(prim, args)
            if len(stack) == 0:
                break  # If stack is empty, all nodes should have been seen
            stack[-1][1].append(string)
    # print(string)
    return string



def _calc_df(inds):
    df = CSVDataloader.get_df(symbols, set_index=True)
    print('CSVDataloader.get_df:')
    print(df)

    names, features = [], []
    ein = enumerate(inds)
    for i, expr in enumerate(inds):
        names.append(f'GP_{i:04d}')
        features.append(stringify_for_sympy(expr))

    new_features = []
    replace = {
        r'ta_ADX\((\d+)\)': r'ta_ADX(high,low,close,\1)',
        r'ta_aroonosc\((\d+)\)': r'ta_aroonosc(high,low,\1)',

    }
    for f in features: #f: 'ts_pct_change(open, 120)'
        new_string = f
        for pattern, replacement in replace.items():
            new_string = re.sub(pattern, replacement, new_string)
        new_features.append(new_string)
    features = new_features
    df = CSVDataloader.calc_expr(df.copy(deep=True), fields=features, names=names)
    # df.set_index([df['symbol'], df.index], inplace=True)
    return df, names

def backtester(evaluate, inds):
    print('+' * 60)
    print('inds:') # [[<deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8460>], [<deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x10f041ae0>, <deap.gp._random_int_ object at 0x10f041a90>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11db7fa70>], [<deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf85f0>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8690>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8780>, <deap.gp._random_int_ object at 0x11dcf87d0>], [<deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8870>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf88c0>, <deap.gp._random_int_ object at 0x11dcf8910>, <deap.gp._random_int_ object at 0x11dcf8960>, <deap.gp._random_int_ object at 0x11dcf89b0>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8a50>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8aa0>, <deap.gp._random_int_ object at 0x11dcf8af0>, <deap.gp._random_int_ object at 0x11dcf8b40>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8be0>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8c30>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8cd0>, <deap.gp._random_int_ object at 0x11dcf8d20>], [<deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8dc0>], [<deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8eb0>, <deap.gp._random_int_ object at 0x11dcf8f50>, <deap.gp._random_int_ object at 0x11dcf8fa0>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf8ff0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9040>, <deap.gp._random_int_ object at 0x11dcf9090>, <deap.gp._random_int_ object at 0x11dcf90e0>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9180>, <deap.gp._random_int_ object at 0x11dcf91d0>, <deap.gp._random_int_ object at 0x11dcf9220>, <deap.gp._random_int_ object at 0x11dcf9270>, <deap.gp._random_int_ object at 0x11dcf92c0>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9360>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9400>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf94f0>, <deap.gp._random_int_ object at 0x11dcf9540>, <deap.gp._random_int_ object at 0x11dcf9590>, <deap.gp._random_int_ object at 0x11dcf95e0>], [<deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf96d0>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9770>, <deap.gp._random_int_ object at 0x11dcf97c0>, <deap.gp._random_int_ object at 0x11dcf9810>], [<deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf98b0>, <deap.gp._random_int_ object at 0x11dcf9900>], [<deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf99a0>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9a40>, <deap.gp._random_int_ object at 0x11dcf9a90>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9b30>, <deap.gp._random_int_ object at 0x11dcf9b80>, <deap.gp._random_int_ object at 0x11dcf9bd0>], [<deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9c70>, <deap.gp._random_int_ object at 0x11dcf9d10>, <deap.gp._random_int_ object at 0x11dcf9d60>, <deap.gp._random_int_ object at 0x11dcf9db0>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9e50>, <deap.gp._random_int_ object at 0x11dcf9ef0>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9f90>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcf9fe0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa030>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa080>, <deap.gp._random_int_ object at 0x11dcfa0d0>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa170>, <deap.gp._random_int_ object at 0x11dcfa1c0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa210>, <deap.gp._random_int_ object at 0x11dcfa260>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa300>, <deap.gp._random_int_ object at 0x11dcfa350>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa3a0>, <deap.gp._random_int_ object at 0x11dcfa3f0>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa490>], [<deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa530>, <deap.gp._random_int_ object at 0x11dcfa580>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa670>, <deap.gp._random_int_ object at 0x11dcfa6c0>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa760>, <deap.gp._random_int_ object at 0x11dcfa7b0>, <deap.gp._random_int_ object at 0x11dcfa800>, <deap.gp._random_int_ object at 0x11dcfa850>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa940>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfa9e0>, <deap.gp._random_int_ object at 0x11dcfaa30>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfaad0>, <deap.gp._random_int_ object at 0x11dcfab20>, <deap.gp._random_int_ object at 0x11dcfab70>, <deap.gp._random_int_ object at 0x11dcfabc0>, <deap.gp._random_int_ object at 0x11dcfac10>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfacb0>, <deap.gp._random_int_ object at 0x11dcfad00>, <deap.gp._random_int_ object at 0x11dcfad50>], [<deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfadf0>, <deap.gp._random_int_ object at 0x11dcfae40>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfae90>, <deap.gp._random_int_ object at 0x11dcfaee0>], [<deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfaf80>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfafd0>, <deap.gp._random_int_ object at 0x11dcfb020>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb0c0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb110>, <deap.gp._random_int_ object at 0x11dcfb160>, <deap.gp._random_int_ object at 0x11dcfb1b0>], [<deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb250>, <deap.gp._random_int_ object at 0x11dcfb2a0>, <deap.gp._random_int_ object at 0x11dcfb2f0>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb390>, <deap.gp._random_int_ object at 0x11dcfb3e0>, <deap.gp._random_int_ object at 0x11dcfb430>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb4d0>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb520>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb5c0>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb660>, <deap.gp._random_int_ object at 0x11dcfb6b0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb700>, <deap.gp._random_int_ object at 0x11dcfb750>, <deap.gp._random_int_ object at 0x11dcfb7a0>], [<deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb840>, <deap.gp._random_int_ object at 0x11dcfb890>, <deap.gp._random_int_ object at 0x11dcfb8e0>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfb980>, <deap.gp._random_int_ object at 0x11dcfb9d0>, <deap.gp._random_int_ object at 0x11dcfba20>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbb10>, <deap.gp._random_int_ object at 0x11dcfbb60>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbbb0>, <deap.gp._random_int_ object at 0x11dcfbc00>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbca0>, <deap.gp._random_int_ object at 0x11dcfbcf0>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbd90>, <deap.gp._random_int_ object at 0x11dcfbde0>, <deap.gp._random_int_ object at 0x11dcfbe30>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbe80>, <deap.gp._random_int_ object at 0x11dcfbed0>, <deap.gp._random_int_ object at 0x11dcfbf20>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dcfbf70>, <deap.gp._random_int_ object at 0x11dcfbfc0>, <deap.gp._random_int_ object at 0x11dd04050>, <deap.gp._random_int_ object at 0x11dd040a0>], [<deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04140>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04190>, <deap.gp._random_int_ object at 0x11dd041e0>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd042d0>], [<deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04370>, <deap.gp._random_int_ object at 0x11dd043c0>], [<deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04460>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04550>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd045f0>, <deap.gp._random_int_ object at 0x11dd04640>, <deap.gp._random_int_ object at 0x11dd04690>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04730>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd047d0>], [<deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04870>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04910>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd049b0>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04a50>, <deap.gp._random_int_ object at 0x11dd04aa0>, <deap.gp._random_int_ object at 0x11dd04af0>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04c30>, <deap.gp._random_int_ object at 0x11dd04c80>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04d20>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04dc0>, <deap.gp._random_int_ object at 0x11dd04e10>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd04f00>, <deap.gp._random_int_ object at 0x11dd04f50>, <deap.gp._random_int_ object at 0x11dd04fa0>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05090>, <deap.gp._random_int_ object at 0x11dd050e0>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05180>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd051d0>, <deap.gp._random_int_ object at 0x11dd05220>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05360>, <deap.gp._random_int_ object at 0x11dd053b0>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05450>, <deap.gp._random_int_ object at 0x11dd054a0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd054f0>, <deap.gp._random_int_ object at 0x11dd05540>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd055e0>, <deap.gp._random_int_ object at 0x11dd05630>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd056d0>, <deap.gp._random_int_ object at 0x11dd05720>], [<deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd057c0>, <deap.gp._random_int_ object at 0x11dd05810>, <deap.gp._random_int_ object at 0x11dd05860>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05900>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd059a0>, <deap.gp._random_int_ object at 0x11dd059f0>, <deap.gp._random_int_ object at 0x11dd05a40>, <deap.gp._random_int_ object at 0x11dd05a90>], [<deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05b80>, <deap.gp._random_int_ object at 0x11dd05bd0>, <deap.gp._random_int_ object at 0x11dd05c20>, <deap.gp._random_int_ object at 0x11dd05c70>], [<deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05d60>, <deap.gp._random_int_ object at 0x11dd05db0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05e00>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05e50>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05ea0>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd05ef0>, <deap.gp._random_int_ object at 0x11dd05f40>, <deap.gp._random_int_ object at 0x11dd05f90>, <deap.gp._random_int_ object at 0x11dd05fe0>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06080>], [<deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06120>, <deap.gp._random_int_ object at 0x11dd06170>, <deap.gp._random_int_ object at 0x11dd061c0>, <deap.gp._random_int_ object at 0x11dd06210>], [<deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06350>, <deap.gp._random_int_ object at 0x11dd063a0>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06440>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd064e0>], [<deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06580>, <deap.gp._random_int_ object at 0x11dd065d0>, <deap.gp._random_int_ object at 0x11dd06620>], [<deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06710>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd067b0>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06850>, <deap.gp._random_int_ object at 0x11dd068a0>, <deap.gp._random_int_ object at 0x11dd068f0>], [<deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06990>, <deap.gp._random_int_ object at 0x11dd069e0>, <deap.gp._random_int_ object at 0x11dd06a30>, <deap.gp._random_int_ object at 0x11dd06a80>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06b70>, <deap.gp._random_int_ object at 0x11dd06bc0>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06c60>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06d50>, <deap.gp._random_int_ object at 0x11dd06da0>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06e40>, <deap.gp._random_int_ object at 0x11dd06e90>, <deap.gp._random_int_ object at 0x11dd06ee0>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd06f80>, <deap.gp._random_int_ object at 0x11dd06fd0>, <deap.gp._random_int_ object at 0x11dd07020>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd070c0>, <deap.gp._random_int_ object at 0x11dd07110>, <deap.gp._random_int_ object at 0x11dd07160>], [<deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07200>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07250>, <deap.gp._random_int_ object at 0x11dd072a0>, <deap.gp._random_int_ object at 0x11dd072f0>, <deap.gp._random_int_ object at 0x11dd07340>], [<deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd073e0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07430>, <deap.gp._random_int_ object at 0x11dd07480>, <deap.gp._random_int_ object at 0x11dd074d0>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07570>, <deap.gp._random_int_ object at 0x11dd075c0>], [<deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07660>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd076b0>, <deap.gp._random_int_ object at 0x11dd07700>, <deap.gp._random_int_ object at 0x11dd07750>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd077f0>, <deap.gp._random_int_ object at 0x11dd07840>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd078e0>, <deap.gp._random_int_ object at 0x11dd07930>, <deap.gp._random_int_ object at 0x11dd07980>, <deap.gp._random_int_ object at 0x11dd079d0>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07ac0>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07b10>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07bb0>], [<deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07c50>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07cf0>, <deap.gp._random_int_ object at 0x11dd07d40>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07d90>], [<deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07e80>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07ed0>, <deap.gp._random_int_ object at 0x11dd07f20>], [<deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd07fc0>, <deap.gp._random_int_ object at 0x11dd10050>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd100a0>, <deap.gp._random_int_ object at 0x11dd100f0>, <deap.gp._random_int_ object at 0x11dd10140>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd101e0>, <deap.gp._random_int_ object at 0x11dd10230>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10320>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd103c0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10410>, <deap.gp._random_int_ object at 0x11dd10460>, <deap.gp._random_int_ object at 0x11dd104b0>, <deap.gp._random_int_ object at 0x11dd10500>], [<deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd105a0>, <deap.gp._random_int_ object at 0x11dd105f0>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10690>], [<deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10780>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10820>], [<deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd108c0>, <deap.gp._random_int_ object at 0x11dd10910>], [<deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd109b0>, <deap.gp._random_int_ object at 0x11dd10a00>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10a50>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10aa0>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdfb00>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10b40>, <deap.gp._random_int_ object at 0x11dd10b90>, <deap.gp._random_int_ object at 0x11dd10be0>, <deap.gp._random_int_ object at 0x11dd10c30>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10d20>, <deap.gp._random_int_ object at 0x11dd10d70>], [<deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdfa60>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10e10>, <deap.gp._random_int_ object at 0x11dd10e60>, <deap.gp._random_int_ object at 0x11dd10eb0>], [<deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd10fa0>, <deap.gp._random_int_ object at 0x11dd10ff0>, <deap.gp._random_int_ object at 0x11dd11040>, <deap.gp._random_int_ object at 0x11dd11090>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd111d0>, <deap.gp._random_int_ object at 0x11dd11220>, <deap.gp._random_int_ object at 0x11dd11270>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd112c0>, <deap.gp._random_int_ object at 0x11dd11310>, <deap.gp._random_int_ object at 0x11dd11360>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11400>, <deap.gp._random_int_ object at 0x11dd11450>, <deap.gp._random_int_ object at 0x11dd114a0>], [<deap.gp.Primitive object at 0x11dcdf510>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Terminal object at 0x11db164c0>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11630>], [<deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd116d0>, <deap.gp._random_int_ object at 0x11dd11720>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd117c0>, <deap.gp.Primitive object at 0x11dcdfa10>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11810>, <deap.gp._random_int_ object at 0x11dd11860>], [<deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11900>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd119a0>, <deap.gp._random_int_ object at 0x11dd119f0>], [<deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11a90>, <deap.gp._random_int_ object at 0x11dd11ae0>, <deap.gp._random_int_ object at 0x11dd11b30>, <deap.gp._random_int_ object at 0x11dd11b80>], [<deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11c70>, <deap.gp._random_int_ object at 0x11dd11cc0>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11d10>, <deap.gp._random_int_ object at 0x11dd11d60>], [<deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11e00>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11e50>, <deap.gp._random_int_ object at 0x11dd11ea0>, <deap.gp._random_int_ object at 0x11dd11ef0>], [<deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd11f90>, <deap.gp._random_int_ object at 0x11dd11fe0>], [<deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf6a0>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12080>, <deap.gp._random_int_ object at 0x11dd120d0>, <deap.gp._random_int_ object at 0x11dd12120>, <deap.gp._random_int_ object at 0x11dd12170>, <deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf470>, <deap.gp.Primitive object at 0x11dcdf5b0>, <deap.gp.Primitive object at 0x11dcdf6f0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd121c0>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12210>, <deap.gp._random_int_ object at 0x11dd12260>], [<deap.gp.Primitive object at 0x11dcdf420>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12300>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12350>], [<deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd123f0>, <deap.gp._random_int_ object at 0x11dd12440>], [<deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Primitive object at 0x11dcdf560>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdf4c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd124e0>, <deap.gp._random_int_ object at 0x11dd12530>], [<deap.gp.Primitive object at 0x11dcdfba0>, <deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf650>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd125d0>, <deap.gp._random_int_ object at 0x11dd12620>, <deap.gp._random_int_ object at 0x11dd12670>], [<deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Primitive object at 0x11dcdfab0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12710>, <deap.gp._random_int_ object at 0x11dd12760>], [<deap.gp.Primitive object at 0x11dcdf920>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12800>], [<deap.gp.Primitive object at 0x11dcdf790>, <deap.gp.Primitive object at 0x11dcdfb50>, <deap.gp.Primitive object at 0x11dcdf970>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf740>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd128a0>, <deap.gp._random_int_ object at 0x11dd128f0>, <deap.gp._random_int_ object at 0x11dd12940>, <deap.gp._random_int_ object at 0x11dd12990>, <deap.gp._random_int_ object at 0x11dd129e0>], [<deap.gp.Primitive object at 0x11dcdf8d0>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf9c0>, <deap.gp.Primitive object at 0x11dcdf600>, <deap.gp.Primitive object at 0x11dcdf830>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12a80>, <deap.gp._random_int_ object at 0x11dd12ad0>, <deap.gp._random_int_ object at 0x11dd12b20>, <deap.gp._random_int_ object at 0x11dd12b70>], [<deap.gp.Primitive object at 0x11dcdf880>, <deap.gp.Primitive object at 0x11dcdf7e0>, <deap.gp.Primitive object at 0x11dcdf2e0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp.Terminal object at 0x11db164c0>, <deap.gp._random_int_ object at 0x11dd12c60>, <deap.gp._random_int_ object at 0x11dd12cb0>]]
    print(inds)
    df, names = _calc_df(inds)
    print('df:')
    print(df)

    print('names:')
    print(names)
    import bt
    from bt_algos_extend import SelectTopK
    close = CSVDataloader.get_col_df(df, 'close')

    print('close:')
    print(close)
    all = []

    for f in names:
        if f in df.columns:
            signal = CSVDataloader.get_col_df(df, f)

            for K in [1]:
                s = bt.Strategy('{}'.format(f), [
                    bt.algos.RunWeekly(),
                    SelectTopK(signal, K),
                    bt.algos.WeighEqually(),
                    bt.algos.Rebalance()])
                all.append(s)

    stras = [bt.Backtest(s, close) for s in all]
    res = bt.run(*stras)
    stats = res.stats
    #print(stats.loc['cagr'])

    results = []
    for name in names:
        if name not in df.columns:
            #results.append((0, 0))
            results.append((0,))
        else:
            results.append((stats.loc['cagr'][name],))
            #results.append((stats.loc['cagr'][name], stats.loc['calmar'][name]))
    print('+' * 60)

    print('results:')
    print(results)

    return results
